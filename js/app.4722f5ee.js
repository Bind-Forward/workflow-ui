(function(e){function t(t){for(var r,o,s=t[0],c=t[1],u=t[2],l=0,p=[];l<s.length;l++)o=s[l],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);d&&d(t);while(p.length)p.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(r=!1)}r&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},i={app:0},a=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/workflow-ui/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var d=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"02e6":function(e,t,n){},"127e":function(e,t,n){"use strict";var r=n("7367"),i=n.n(r);i.a},"197f":function(e,t,n){},2395:function(e,t,n){},"4b95":function(e,t,n){},6783:function(e,t,n){},"68d9":function(e,t){},7367:function(e,t,n){},"7c55":function(e,t,n){"use strict";var r=n("2395"),i=n.n(r);i.a},"8be8":function(e,t,n){},"94db":function(e,t,n){"use strict";var r=n("197f"),i=n.n(r);i.a},"9c99":function(e,t,n){},a16e:function(e,t,n){"use strict";var r=n("4b95"),i=n.n(r);i.a},a5e9:function(e,t,n){"use strict";var r=n("6783"),i=n.n(r);i.a},b3f9:function(e,t,n){"use strict";var r=n("8be8"),i=n.n(r);i.a},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"op-container"},[n("div",{staticClass:"type-list"},e._l(e.testNode,(function(t,r){return n("div",{directives:[{name:"draggable-nodetype",rawName:"v-draggable-nodetype",value:t,expression:"item"}],key:r,staticClass:"con"},[n("i",{staticClass:"iconfont",domProps:{innerHTML:e._s(t.icon)}}),n("div",{staticClass:"name"},[e._v(e._s(t.name))])])})),0),n("ChartView",{ref:"chart",attrs:{width:"800px",height:"600px",contextMenuList:[{label:"删除",onClick:function(t){return e.contextMenuClick(t,"删除")}},{label:"编辑",onClick:function(t){return e.contextMenuClick(t,"编辑")}}]},on:{"node-created":e.nodeCreated,"node-dblclick":e.nodeSelected,"node-deleted":e.nodeDeleted,"edge-dblclick":e.edgeSelected,"edge-connected":e.edgeConnected}}),e.showEditBox?n("div",{staticClass:"edit-item"},[n("div",{staticClass:"con"},[e._v("类型："+e._s(e.currentEditingItem.itemType))]),n("div",{staticClass:"con"},[e._v("id："+e._s(e.currentEditingItem.id))]),n("div",{staticClass:"con"},[e._v("节点类型: "+e._s(e.currentEditingItem.nodeType))]),n("div",{staticClass:"con"},[e._v("标题:"),n("input",{directives:[{name:"model",rawName:"v-model",value:e.currentEditingItem.task.title,expression:"currentEditingItem.task.title"}],attrs:{type:"text"},domProps:{value:e.currentEditingItem.task.title},on:{input:function(t){t.target.composing||e.$set(e.currentEditingItem.task,"title",t.target.value)}}})]),n("div",{staticClass:"con"},[e._v("状态: "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.currentEditingItem.task.status,expression:"currentEditingItem.task.status"}],on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.currentEditingItem.task,"status",t.target.multiple?n:n[0])}}},[n("option",{attrs:{value:"未开始"}},[e._v("未开始")]),n("option",{attrs:{value:"执行中"}},[e._v("执行中")]),n("option",{attrs:{value:"执行失败"}},[e._v("执行失败")]),n("option",{attrs:{value:"执行成功"}},[e._v("执行成功")])])]),n("button",{staticClass:"btn",on:{click:function(t){return e.updateItem(e.currentEditingItem.itemType,e.currentEditingItem.id,e.currentEditingItem.task)}}},[e._v("更新节点")]),n("button",{staticClass:"btn",on:{click:function(t){return e.printPrevNodes(e.currentEditingItem.id)}}},[e._v("获取前置节点")]),n("button",{staticClass:"btn",on:{click:function(t){return e.getNodeById(e.currentEditingItem.id)}}},[e._v("获取当前节点")]),n("button",{staticClass:"btn",on:{click:function(t){return e.deleteItem("node",e.currentEditingItem.id)}}},[e._v("删除节点")]),n("button",{staticClass:"btn",on:{click:function(t){e.showEditBox=!e.showEditBox}}},[e._v("关闭弹窗")])]):e._e()],1),n("div",{staticClass:"btnBox"},[n("button",{staticClass:"btn",on:{click:e.getData}},[e._v("获取数据")]),n("button",{staticClass:"btn",on:{click:e.changeData}},[e._v("更改数据")]),n("button",{staticClass:"btn",on:{click:e.createNode}},[e._v("创建工具节点")])])])},a=[],o=(n("96cf"),n("1da1")),s=n("60a3"),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"chart-view"},[n("div",{ref:"workSpace",staticClass:"work-space",style:e.workFlowStyle,on:{dragenter:e.preventHandler,dragover:e.preventHandler,drop:e.dropHandler}},[n("div",{staticClass:"plugins-layer"},[n("plugin-layer",{attrs:{plugins:e.plugins}})],1),n("div",{ref:"drawLayer",staticClass:"draw-layer"},[n("DrawPart",{ref:"chart",staticClass:"node-list-container"})],1),e.contextMenuList.length?n("vue-context",{ref:"contextMenu",staticClass:"context-menu",scopedSlots:e._u([{key:"default",fn:function(t){return e._l(e.contextMenuList,(function(r){return n("li",{key:r.label,staticClass:"context-item"},[n("a",{staticClass:"context-item-link",domProps:{textContent:e._s(r.label)},on:{click:function(n){return n.preventDefault(),e.contextMenuItemClick(r,t.data)}}})])}))}}],null,!1,201515628)}):e._e()],1)])},u=[],d=(n("99af"),n("4de4"),n("7db0"),n("c740"),n("4160"),n("caad"),n("a15b"),n("d81d"),n("13d5"),n("a434"),n("4fad"),n("b64b"),n("d3b7"),n("2532"),n("159b"),n("2909")),l=n("d4ec"),p=n("bee2"),f=n("262e"),v=n("2caf"),h=n("3835"),m=n("9ab4"),g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"container",staticClass:"draw-part",on:{click:e.itemBlurHandler}},e._l(e.nodes,(function(t){return n("div",{key:t.id,staticClass:"node-item",style:{left:t.x+"px",top:t.y+"px"},attrs:{id:t.id,"data-nodetype":t.nodeType},on:{dblclick:function(n){return e.nodeDblclickHandler(n,t)},contextmenu:function(n){return e.nodeContextMenuHandler(n,t)}}},[n(t.nodeType,e._b({tag:"component"},"component",t.task,!1))],1)})),0)},b=[],y=(n("45fc"),n("b0c0"),n("5530")),k=n("e193"),w=n("257e"),j=function(){function e(t,n){Object(l["a"])(this,e),this.selected=!1,this.id=n.id||k["jsPlumbUtil"].uuid(),this.task=n.task||{},this.vm=t}return Object(p["a"])(e,[{key:"getJsplumbInstance",value:function(){return this.vm.jsplumbInstance}}]),e}(),O=n("0644"),x=n.n(O),C=function(e){Object(f["a"])(n,e);var t=Object(v["a"])(n);function n(e,r){var i;Object(l["a"])(this,n),i=t.call(this,e,r),i.endPoints=[],i.x=r.x,i.y=r.y,i.nodeType=r.nodeType,setTimeout((function(){i.setDefaultCfg(),i.setDraggable()}),0);var a=x()(r);return Object.assign(Object(w["a"])(i),a),i}return Object(p["a"])(n,[{key:"updateTask",value:function(e){this.task=x()(e)}},{key:"setSelected",value:function(e,t){this.dom=t,this.vm.$set(this,"selected",e),e?t.classList.add("node-selected"):t.classList.remove("node-selected")}},{key:"setDefaultCfg",value:function(){var e={allowLoopback:!1},t=this.getJsplumbInstance();t.addEndpoint(this.id,{uuid:"out-"+this.id,isSource:!0,anchors:["Right"],endpoint:["Dot",{radius:6,cssClass:"end-point",hoverClass:"end-point-hover"}]},e),t.addEndpoint(this.id,{uuid:"in-"+this.id,isTarget:!0,anchors:["Left"],endpoint:["Rectangle",{width:10,height:10,cssClass:"end-point",hoverClass:"end-point-hover"}]},e)}},{key:"setDraggable",value:function(){var e=this,t=this.getJsplumbInstance();t.draggable(this.id,{stop:function(t){var n=Object(h["a"])(t.pos,2),r=n[0],i=n[1];e.x=r,e.y=i}})}}]),n}(j);function I(e,t){var n=new C(e,t);return e.nodes.push(n),n}var E=function(e){Object(f["a"])(n,e);var t=Object(v["a"])(n);function n(e,r){var i;Object(l["a"])(this,n),i=t.call(this,e,r),i.sourceId=r.sourceId,i.targetId=r.targetId;var a=r.connection||i.connect(i.sourceId,i.targetId);return a.setData(Object(w["a"])(i)),i.connection=a,i.initOverlays(r),a.bind("dblclick",(function(t,n){n.stopPropagation(),i.setSelected(!0),e.apiEmit("edge-dblclick",Object(w["a"])(i))})),i}return Object(p["a"])(n,[{key:"setOverLay",value:function(e,t){var n=this.connection.getOverlay(e);n?n.setLabel(t[1].label||""):(t[1].id=t[1].id||e,this.connection.addOverlay(t))}},{key:"updateTask",value:function(e){this.task=x()(e),this.setCondition(e.condition)}},{key:"setSelected",value:function(e){this.selected=e,e?(this.connection.addClass("edge-selected"),this.connection.setHover(!0)):this.connection.removeClass("edge-selected")}},{key:"connect",value:function(e,t){return this.getJsplumbInstance().connect({uuids:["out-"+e,"in-"+t]})}},{key:"initOverlays",value:function(e){this.setOverLay("arrow",["Arrow",{id:"arrow",location:.95,width:9,length:12}]),this.setCondition(e.task.condition)}},{key:"setCondition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.task.condition=e,this.setOverLay("condition",["Label",{id:"condition",label:e,location:.8,cssClass:"wfui-condition-label"}])}}]),n}(j);function _(e,t){return new E(e,t)}var D={MaxConnections:-1,Connector:["Bezier",{curviness:55}],PaintStyle:{stroke:"#345",strokeWidth:2,"stroke-dasharray":[2,2]},HoverPaintStyle:{stroke:"#00abfb",strokeWidth:5}};function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((function(t){setTimeout((function(){t()}),e)}))}function N(e){var t=e.parentElement;if(t&&"BODY"!==e.tagName)return t.dataset.nodetype?e:N(e.parentElement)}var P={},S=function(e){Object(f["a"])(n,e);var t=Object(v["a"])(n);function n(){var e;return Object(l["a"])(this,n),e=t.apply(this,arguments),e.nodes=[],e.jsplumbInstance=k["jsPlumb"].getInstance(),e}return Object(p["a"])(n,[{key:"mounted",value:function(){var e=this.jsplumbInstance;e.importDefaults(D);var t=this.$refs.container;e.setContainer(t)}},{key:"initNodes",value:function(e){var t=this;return new Promise((function(n){t.jsplumbInstance.ready(Object(o["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.map((function(e){return I(t,e)})),r.next=3,T();case 3:n();case 4:case"end":return r.stop()}}),r)}))))}))}},{key:"initEdges",value:function(e){var t=this;return new Promise((function(n){t.jsplumbInstance.ready((function(){e.forEach((function(e){return _(t,e)})),n()}))}))}},{key:"initJsplumbEvents",value:function(){var e=this.jsplumbInstance,t=this;e.bind("beforeDrop",(function(e){var n=e.dropEndpoint,r=e.connection;if(!n)throw Error("drop在作为Target的节点上了吗? check it");var i=n.connections.some((function(e){return e.targetId===r.targetId&&e.sourceId===r.sourceId}));return!i&&(_(t,Object(y["a"])(Object(y["a"])({},r),{},{task:{}})),!0)})),e.bind("connection",(function(e,n){console.log("connection event");var r=_(t,{id:e.connection.getId(),task:{},sourceId:e.sourceId,targetId:e.targetId,connection:e.connection});t.apiEmit("edge-connected",r)}))}},{key:"itemBlurHandler",value:function(){this.nodes.forEach((function(e){e.dom&&e.setSelected(!1,e.dom)})),this.jsplumbInstance.getConnections().forEach((function(e){var t=e.getData();t.setSelected(!1)}))}},{key:"nodeDblclickHandler",value:function(e,t){e.stopPropagation(),this.itemBlurHandler();var n=t.dom||N(e.target);n&&(t.setSelected(!0,n),this.apiEmit("node-dblclick",t))}},{key:"nodeContextMenuHandler",value:function(e,t){e.stopPropagation(),e.preventDefault(),this.itemBlurHandler(),this.apiEmit("node-contextmenu",t,e)}}],[{key:"registNodeType",value:function(e,t){if(P[e])throw new Error("此组件(".concat(e,")已存在, 请勿重复注册."));t.name=e,P[e]=t,this.component(e,t),console.log(P,"当前已注册组件")}}]),n}(s["e"]);Object(m["a"])([Object(s["b"])("apiEmit")],S.prototype,"apiEmit",void 0),S=Object(m["a"])([Object(s["a"])({})],S);var L=S,$=L,B=(n("127e"),n("2877")),H=Object(B["a"])($,g,b,!1,null,"494c61fe",null),R=H.exports,M=n("e2a0"),V=n.n(M),F=function(e){Object(f["a"])(n,e);var t=Object(v["a"])(n);function n(){return Object(l["a"])(this,n),t.apply(this,arguments)}return Object(p["a"])(n,[{key:"render",value:function(e){return e("div",this.plugins)}}]),n}(s["e"]);Object(m["a"])([Object(s["c"])()],F.prototype,"plugins",void 0),F=Object(m["a"])([Object(s["a"])({})],F);var z,J,Y=F,A=Y,X=Object(B["a"])(A,z,J,!1,null,null,null),W=X.exports,U=n("899b");n("4598");function Z(e,t){var n=[],r=e,i=function e(i){var a=t.filter((function(e){return e.targetId===i})).map((function(e){return e.sourceId}));return a.forEach((function(t){n.includes(t)||t===r||(n.push(t),e(t))})),n};return i(e),n}function q(e){return Object.entries(e).reduce((function(e,t){var n=Object(h["a"])(t,2),r=n[0],i=n[1];return"vm"!==r&&(e[r]=i),"task"===r&&(e[r]=x()(i)),e}),{})}function G(e){return"string"===typeof e?e:e+"px"}var K=[],Q=function(e){Object(f["a"])(n,e);var t=Object(v["a"])(n);function n(){var e;return Object(l["a"])(this,n),e=t.apply(this,arguments),e.plugins=[],e}return Object(p["a"])(n,[{key:"initChart",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=this.drawPart,n.jsplumbInstance.reset(),n.nodes=[],r=x()(t.nodes),i=x()(t.edges),e.next=7,n.initNodes(r);case 7:return e.next=9,n.initEdges(i);case 9:return n.initJsplumbEvents(),e.abrupt("return",Promise.resolve());case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setData",value:function(e){return this.initChart(e)}},{key:"createNode",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,I(this.drawPart,x()(t));case 2:return n=e.sent,e.next=5,T();case 5:this.apiEmit("node-created",n);case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"deleteItem",value:function(e,t){var n={node:this.deleteNode,edge:this.deleteEdge};return n[e](t)}},{key:"updateItem",value:function(e,t,n){var r={node:this.updateNode,edge:this.updateEdge};return r[e](t,n)}},{key:"getData",value:function(){var e=this.getNodes(),t=this.getEdges();return{nodes:e.map(q),edges:t.map(q)}}},{key:"getNodeById",value:function(e){var t=this.drawPart.nodes;return t.find((function(t){return t.id===e}))}},{key:"getPreviousNodes",value:function(e){var t=this.getData(),n=t.nodes,r=t.edges,i=n.find((function(t){return t.id===e}));if(!i)throw new Error("当前节点(id:".concat(e,")不存在"));var a=Z(e,r);return a.map(this.getNodeById)}},{key:"contextMenuItemClick",value:function(e,t){e.onClick(x()(t))}},{key:"deleteNode",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=this.drawPart,n.jsplumbInstance.remove(t),r=n.nodes.findIndex((function(e){return e.id===t})),-1!==r){e.next=5;break}throw new Error("没有id: ".concat(t,"为的节点"));case 5:return i=n.nodes[r],n.nodes.splice(r,1),e.next=9,T();case 9:return e.abrupt("return",i);case 10:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"deleteEdge",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=this.drawPart.jsplumbInstance,r=n.getConnections(),i=r.filter((function(e){return e.getId()===t}))[0],i?n.deleteConnection(i):console.error("此id没有对应的edge");case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"updateNode",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t,n){var r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=this.drawPart,i=r.nodes.filter((function(e){return e.id===t}))[0],i?i.updateTask(x()(n)):console.error("未获取到id为(".concat(t,")的节点")),e.next=5,T();case 5:this.apiEmit("node-updated",{id:i.id,nodeType:i.nodeType,selected:i.selected,task:i.task});case 6:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"updateEdge",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t,n){var r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=this.drawPart.jsplumbInstance.getConnections(),i=r.map((function(e){return e.getData()})).filter((function(e){return e.id===t}))[0],i?i.updateTask(n):console.error("此id没有对应的edge");case 3:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"getNodes",value:function(){return this.drawPart.nodes.map((function(e){return e}))}},{key:"getEdges",value:function(){var e=this.drawPart.jsplumbInstance.getConnections();return e.map((function(e){return e.getData()}))}},{key:"dropHandler",value:function(e){e.preventDefault();var t=e.dataTransfer.getData("nodeType");if(!V()(t))throw new TypeError("获取节点类型失败");var n=this.drawPart.$el.getBoundingClientRect(),r=e.clientX-n.x-20,i=e.clientY-n.y-20,a=Object.keys(P);if(!a.includes(t))throw new Error("".concat(t,"节点类型未注册;\n\n当前已注册节点类型: [").concat(a.join(","),"]"));var o=e.dataTransfer.getData("task");this.createNode({x:r,y:i,nodeType:t,task:JSON.parse(o)})}},{key:"preventHandler",value:function(e){e.preventDefault()}},{key:"apiEmit",value:function(e,t,n){var r=q(t);this.$emit(e,r),"node-contextmenu"===e&&this.$refs.contextMenu.open(n,r)}},{key:"mounted",value:function(){var e,t=this,n=this,r=this.$refs.workSpace,i=this.drawPart.jsplumbInstance,a=K.map((function(e){return e.call(t,r,n,i)})).filter((function(e){return e}));(e=this.plugins).push.apply(e,Object(d["a"])(a))}},{key:"beforeDestroy",value:function(){this.$emit("hook:beforeDestory")}},{key:"drawPart",get:function(){return this.$refs.chart}},{key:"workFlowStyle",get:function(){return{width:G(this.width),height:G(this.height)}}}],[{key:"registNodeTypeByRender",value:function(e,t){return R.registNodeType(e,t)}},{key:"registNodeType",value:function(e,t,n,r){n&&r||console.warn("width或height未传入, 请确保已经在组件内部固定了节点宽高");var i=R.registNodeType.bind(R);i(e,{name:e,functional:!0,render:function(e,i){var a;n&&r&&(a={width:"".concat(n,"px"),height:"".concat(r,"px")});var o={props:i.props,style:a};return e(t,o)}})}},{key:"registPlugins",value:function(e){K.push.apply(K,Object(d["a"])(e))}}]),n}(s["e"]);Object(m["a"])([Object(s["c"])({default:[]})],Q.prototype,"contextMenuList",void 0),Object(m["a"])([Object(s["c"])({default:800})],Q.prototype,"width",void 0),Object(m["a"])([Object(s["c"])({default:600})],Q.prototype,"height",void 0),Object(m["a"])([Object(s["d"])()],Q.prototype,"apiEmit",null),Q=Object(m["a"])([Object(s["a"])({components:{DrawPart:R,PluginLayer:W,VueContext:U["a"]}})],Q);var ee=Q,te=ee,ne=(n("94db"),n("68d9")),re=n.n(ne),ie=Object(B["a"])(te,c,u,!1,null,"2dfee948",null);"function"===typeof re.a&&re()(ie);var ae=ie.exports,oe={inserted:function(e,t){var n=t.value;if(!n||!n.nodeType)throw new Error('v-draggableNodetype需要传入一个对象, 如: { nodeType: "SimpleFlowNode", task: { ...节点类型数据 } }. task(非必传)内容会被深拷贝到节点task中');n.task=n.task||{};var r=n.nodeType,i=n.task;e.draggable=!0,e.ondragstart=function(e){e.dataTransfer.setData("nodeType",r),e.dataTransfer.setData("task",JSON.stringify(i))},e.ondragend=function(e){return e.preventDefault()},e.ondragover=function(e){return e.preventDefault()}}},se=oe,ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"draggable-bg",style:{backgroundPosition:e.backgroundPosition}})},ue=[],de=function(e){Object(f["a"])(n,e);var t=Object(v["a"])(n);function n(){var e;return Object(l["a"])(this,n),e=t.apply(this,arguments),e.dragView={isDragging:!1,startX:0,startY:0},e.nodeListStyle={left:"0px",top:"0px"},e.backgroundPosition="",e}return Object(p["a"])(n,[{key:"mousedownHandler",value:function(e){this.dragView={isDragging:!0,startX:e.x,startY:e.y}}},{key:"mousemoveHandler",value:function(e){if(this.dragView.isDragging){var t=e.x-this.dragView.startX,n=e.y-this.dragView.startY;this.dragView.startX=e.x,this.dragView.startY=e.y,this.moveHandler(t,n)}}},{key:"mouseupHandler",value:function(e){this.dragView.isDragging=!1}},{key:"moveHandler",value:function(e,t){var n=this.nodeListStyle,r=n.left,i=n.top,a=this.nodeListStyle.left=parseFloat(r)+e+"px",o=this.nodeListStyle.top=parseFloat(i)+t+"px";this.backgroundPosition="left ".concat(a," top ").concat(o),this.drawLayerDom.style.left=a,this.drawLayerDom.style.top=o}},{key:"mounted",value:function(){var e=this.drawLayerDom=this.chartViewVm.$refs.drawLayer;e.style.position="relative",this.workSpace.addEventListener("mousedown",this.mousedownHandler),this.workSpace.addEventListener("mousemove",this.mousemoveHandler),document.body.addEventListener("mouseup",this.mouseupHandler)}},{key:"beforeDestory",value:function(){console.log("hook beforeDestory"),this.workSpace.removeEventListener("mousedown",this.mousedownHandler),this.workSpace.removeEventListener("mousemove",this.mousemoveHandler),document.body.removeEventListener("mouseup",this.mouseupHandler)}}]),n}(s["e"]);Object(m["a"])([Object(s["c"])()],de.prototype,"chartViewVm",void 0),Object(m["a"])([Object(s["c"])()],de.prototype,"workSpace",void 0),de=Object(m["a"])([s["a"]],de);var le=de,pe=le,fe=(n("a5e9"),Object(B["a"])(pe,ce,ue,!1,null,"f8f4b826",null)),ve=fe.exports,he=function(e,t,n){var r=t.$createElement,i=r(ve,{props:{chartViewVm:t,workSpace:e}});return i},me=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"zoom-control"},[n("i",{staticClass:"iconfont icon-jianshao",class:["icon",{disabled:e.minusDisabled}],on:{click:function(t){return e.change(-e.defaultIncrement)}}}),n("span",{staticClass:"zoom-rate"},[e._v(e._s(e.zoomRate)+"%")]),n("i",{staticClass:"iconfont icon-zengjia-cuxiantiao",class:["icon",{disabled:e.addDisabled}],on:{click:function(t){return e.change(+e.defaultIncrement)}}})])},ge=[],be=(n("02e6"),function(e){Object(f["a"])(n,e);var t=Object(v["a"])(n);function n(){var e;return Object(l["a"])(this,n),e=t.apply(this,arguments),e.defaultIncrement=10,e.zoomRate=100,e.addDisabled=!1,e.minusDisabled=!1,e}return Object(p["a"])(n,[{key:"change",value:function(e){var t=this.zoomRate+e;t<50?(t=50,this.minusDisabled=!0):t>200?(t=200,this.addDisabled=!0):(this.addDisabled=!1,this.minusDisabled=!1),this.zoomRate=t;var n=t/100;this.drawLayerDom.style.transform="scale(".concat(n,")"),this.jsplumbInstance.setZoom(n)}}]),n}(s["e"]));Object(m["a"])([Object(s["c"])()],be.prototype,"jsplumbInstance",void 0),Object(m["a"])([Object(s["c"])()],be.prototype,"drawLayerDom",void 0),be=Object(m["a"])([s["a"]],be);var ye=be,ke=ye,we=(n("d9f4"),Object(B["a"])(ke,me,ge,!1,null,"b2ad3472",null)),je=we.exports,Oe=function(e,t,n){var r=t.$createElement,i=t.$refs.drawLayer,a=r(je,{props:{drawLayerDom:i,jsplumbInstance:n}});return a};ae.registPlugins([he,Oe]);var xe=se,Ce=ae,Ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("button",{staticClass:"log-btn",on:{click:e.log}},[e._v("btn")])])},Ee=[],_e={name:"Demo",props:["compTitle"],methods:{log:function(){console.log("当前组件标题: "+this.compTitle)}}},De=_e,Te=(n("b3f9"),Object(B["a"])(De,Ie,Ee,!1,null,"833f5bd8",null)),Ne=(Te.exports,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"default-flow-node",style:{color:e.mainColor,borderColor:e.mainColor}},[n("div",{staticClass:"iconfont",style:{color:e.mainColor}},[e._v("")]),n("div",{staticClass:"title"},[n("span",{domProps:{textContent:e._s(e.title)}}),n("span",{staticClass:"des",domProps:{textContent:e._s(e.status)}})])])}),Pe=[],Se={name:"DefaultFlowNode",props:{title:{type:String,default:"请输入标题"},status:{type:String,default:"未开始",validator:function(e){var t=["未开始","执行中","执行成功","执行失败"].includes(e);return t}}},computed:{mainColor:function(){var e={"未开始":"#4c4c4b","执行中":"#6888EA","执行成功":"#08c692","执行失败":"#fe0001"};return e[this.status]}}},Le=Se,$e=(n("a16e"),Object(B["a"])(Le,Ne,Pe,!1,null,"f1330de0",null)),Be=$e.exports;Ce.registNodeTypeByRender("Condition",{name:"Condition",functional:!0,props:{title:String},render:function(e){return e("div",[e("i",{style:{width:"32px",height:"32px",fontSize:"32px"},attrs:{class:"iconfont icon-tiaojian"}})])}}),Ce.registNodeTypeByRender("Control",{name:"Control",functional:!0,props:{title:String},render:function(e){return e("div",[e("i",{style:{width:"32px",height:"32px",fontSize:"32px"},attrs:{class:"iconfont icon-changyongtubiao_Farmshezhi"}})])}}),Ce.registNodeType("FlowNode",Be);var He={name:"App",components:{ChartView:Ce},directives:{draggableNodetype:xe},data:function(){return{testNode:[{nodeType:"Control",name:"控制",icon:"&#xe602;"},{nodeType:"Condition",name:"条件",icon:"&#xe6d8;"},{nodeType:"FlowNode",name:"流程节点",icon:"&#xe627;"}],showEditBox:!1,currentEditingItem:{itemType:"",task:{}}}},methods:{nodeDeleted:function(e){console.log("删除",e)},nodeCreated:function(e){console.log("创建",e)},nodeSelected:function(e){console.log("双击节点",e),this.showEditBox=!0,this.currentEditingItem=Object.assign({itemType:"node"},e)},edgeSelected:function(e){console.log("双击边",e)},edgeConnected:function(e){console.log("边连线",e);var t=e.id;this.$refs.chart.updateItem("edge",t,{condition:"yes"})},getData:function(){console.log("流程数据",this.$refs.chart.getData())},changeData:function(){this.$refs.chart.setData({nodes:[{id:"1",x:10,y:50,nodeType:"FlowNode",task:{title:"更改数据",status:"执行成功"}}],edges:[]})},createNode:function(){this.$refs.chart.createNode({nodeType:"FlowNode",task:{title:"新创建",des:"新描述",status:"执行失败"}})},updateItem:function(e,t,n){this.$refs.chart.updateItem(e,t,n),this.showEditBox=!1},printPrevNodes:function(e){console.log("前置节点",this.$refs.chart.getPreviousNodes(e)),this.showEditBox=!1},getNodeById:function(e){console.log("当前节点",this.$refs.chart.getNodeById(e)),this.showEditBox=!1},deleteItem:function(e,t){this.$refs.chart.deleteItem(e,t),this.showEditBox=!1},contextMenuClick:function(e,t){"删除"===t?this.$refs.chart.deleteItem("node",e.id):"编辑"===t&&(this.showEditBox=!0,this.currentEditingItem=Object.assign({itemType:"node"},e))}},mounted:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.chart.initChart({nodes:[{id:"1",x:10,y:50,nodeType:"FlowNode",task:{title:"初始节点",status:"执行成功"}},{id:"2",x:250,y:80,nodeType:"Condition",task:{}},{id:"3",x:400,y:52,nodeType:"FlowNode",task:{title:"流程A",status:"未开始"}},{id:"4",x:400,y:150,nodeType:"FlowNode",task:{title:"流程B",status:"执行中"}},{id:"5",x:650,y:80,nodeType:"Control",task:{}},{id:"6",x:800,y:80,nodeType:"FlowNode",task:{title:"结束节点",status:"执行失败"}}],edges:[{id:"_jsplumb_c_1593419365488",sourceId:"1",targetId:"2",task:{}},{id:"_jsplumb_c_1593419365489",sourceId:"2",targetId:"3",task:{condition:"yes"}},{id:"_jsplumb_c_1593419365490",sourceId:"2",targetId:"4",task:{condition:"no"}},{id:"_jsplumb_c_1593419365491",sourceId:"3",targetId:"5",task:{}},{id:"_jsplumb_c_1593419365492",sourceId:"4",targetId:"5",task:{}},{id:"_jsplumb_c_1593419365493",sourceId:"5",targetId:"6",task:{}}]});case 1:case"end":return t.stop()}}),t)})))()}},Re=He,Me=(n("7c55"),Object(B["a"])(Re,i,a,!1,null,null,null)),Ve=Me.exports;r["a"].config.productionTip=!1,new r["a"]({render:function(e){return e(Ve)}}).$mount("#app")},d9f4:function(e,t,n){"use strict";var r=n("9c99"),i=n.n(r);i.a}});
//# sourceMappingURL=app.4722f5ee.js.map